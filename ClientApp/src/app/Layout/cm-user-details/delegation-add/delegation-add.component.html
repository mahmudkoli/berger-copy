<div class="main-card mb-3 card">

    <div class="card-header sticky-card d-flex justify-content-between align-items-center">
        <div class="card-header-title font-size-lg text-capitalize font-weight-normal">Delegation Form</div>
        <div class="btn-actions-pane-right">
            <!--<button type="button" class="mb-2 mr-2 btn-transition btn btn-outline-success" (click)="delegationList()">
                <fa class="mr-2" name="list"></fa>
                Back to list
            </button>-->
        </div>
    </div>

    <div class="card-body">
        <form #delegationForm="ngForm" (submit)="saveDelegation(delegationModel)">
            <div class="form-row">
                <div class="col-md-6">
                    <div class="position-relative form-group">
                        <label for="deligatedFromUserId">Delegated From User</label>
                        <ng-select required name="deligatedFromUserId" #deligatedFromUserId="ngModel" id="deligatedFromUserId" [(ngModel)]="delegationModel.deligatedFromUserId" 
                        
                        [ngClass]="{'is-valid':deligatedFromUserId.valid,'is-invalid':deligatedFromUserId.invalid && deligatedFromUserId.touched }"
                        (change)="validateFromUser($event)">
                            <ng-option *ngFor="let userInfo of this.userInfoList; index as i" [value]="userInfo.id"> {{userInfo.name}} </ng-option>
                        </ng-select>
                        <small class="text-danger" [class.d-none]="deligatedFromUserId.valid || deligatedFromUserId.untouched">
                            Delegated From User is required
                        </small>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="position-relative form-group">
                        <label for="deligatedToUserId">Delegated To User</label>
                        <ng-select required name="deligatedToUserId" #deligatedToUserId="ngModel" id="deligatedToUserId" 
                        
                        [(ngModel)]="delegationModel.deligatedToUserId" [ngClass]="{'is-valid':deligatedToUserId.valid,'is-invalid':deligatedToUserId.invalid && deligatedToUserId.touched }"
                        (change)="validateToUser($event)">
                            <ng-option *ngFor="let userInfo of this.userInfoList; index as i" [value]="userInfo.id"> {{userInfo.name}} </ng-option>
                        </ng-select>
                        <small class="text-danger" [class.d-none]="deligatedToUserId.valid || deligatedToUserId.untouched">
                            Delegated To User is required
                        </small>
                    </div>
                </div>
                <div class="col-md-6">
                    <label for="exampleInputText">Date</label>
                    <div class="form-inline flex-nowrap">
                        <div class="form-group hidden">
                            <div class="input-group">
                                <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                                       [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2"
                                       [dayTemplate]="t" outsideDays="hidden" [startDate]="fromDate">
                                <ng-template #t let-date let-focused="focused">
                                    <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                                          [class.faded]="isHovered(date) || isInside(date)"
                                          (mouseenter)="hoveredDate = date" (mouseleave)="hoveredDate = null">
                                        {{ date.day }}
                                    </span>
                                </ng-template>
                            </div>
                        </div>
                        <div class="form-group" style="flex: 0 0 calc(50% - 4px)">
                            <div class="input-group w-100">
                                <input #dpFromDate class="form-control" placeholder="yyyy-mm-dd" name="dpFromDate"
                                       [value]="formatter.format(delegationModel.frombDate)"
                                       (input)="delegationModel.frombDate = validateInput(delegationModel.frombDate, dpFromDate.value)">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                                            type="button"></button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group ml-2" style="flex: 0 0 calc(50% - 4px)">
                            <div class="input-group w-100">
                                <input #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                                       [value]="formatter.format(delegationModel.tobDate)"
                                       (input)="delegationModel.tobDate = validateInput(delegationModel.tobDate, dpToDate.value)">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="datepicker.toggle()"
                                            type="button"></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="name">Note</label>
                        <textarea required name="name" [(ngModel)]="delegationModel.name" type="text" style="resize: none;" class="form-control" id="name"></textarea>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" class="mb-2 mr-2 btn-hover-shine btn btn-dark" (click)="delegationList()"><i class="pe-7s-back pr-1"></i> Back </button>
                <button type="submit" class="mb-2 btn btn-primary"><i class="fa fa-save pr-1"></i> Save </button>
            </div>
        </form>
    </div>
</div>
